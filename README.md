# Software-testing
insert into person_lesson (person_id, lesson_id)
VALUES (2, 1);

select * from person_lesson;

insert into person_lesson (person_id, lesson_id)
VALUES (2, 2);

select * from person_lesson;

insert into person_lesson (person_id, lesson_id)
VALUES (2, 2);

select * from person_lesson;

insert into person_lesson (person_id, lesson_id)
VALUES (2, 3);

select * from person_lesson;

insert into person_lesson (person_id, lesson_id)
VALUES (2, 4);

select * from person_lesson;

insert into person_lesson (person_id, lesson_id)
VALUES (2, 5);

select * from person_lesson;

insert into person_lesson (person_id, lesson_id)
VALUES (2, 6);

select * from person_lesson;

insert into person_lesson (person_id, lesson_id)
VALUES (2, 7);

select * from person_lesson;

insert into person_lesson (person_id, lesson_id)
VALUES (2, 8);

select * from person_lesson;

insert into person_lesson (person_id, lesson_id)
VALUES (2, 9);

select * from person_lesson;

insert into person_lesson (person_id, lesson_id)
VALUES (2, 10);

select * from person_lesson;

insert into person_lesson (person_id, lesson_id)
VALUES (2, 11);

select * from person_lesson;

insert into person_lesson (person_id, lesson_id)
VALUES (2, 12);

select * from person_lesson;

insert into person_lesson (person_id, lesson_id)
VALUES (2, 13);

select * from person_lesson;

insert into person_lesson (person_id, lesson_id)
VALUES (2, 14);

select * from person_lesson;

insert into person_lesson (person_id, lesson_id)
VALUES (2, 15);

select * from person_lesson;

insert into person_lesson (person_id, lesson_id)
VALUES (2, 16);

select * from person_lesson;

insert into person_lesson (person_id, lesson_id)
VALUES (2, 16);

select * from person_lesson;

delete from person_lesson;

select * from person_lesson;

insert into person_lesson (person_id, lesson_id)
VALUES (2, 1);

select * from person_lesson;

insert into person_lesson (person_id, lesson_id)
VALUES (2, 2);

select * from person_lesson;

insert into person_lesson (person_id, lesson_id)
VALUES (2, 3);

select * from person_lesson;

insert into person_lesson (person_id, lesson_id)
VALUES (2, 4);

select * from person_lesson;

insert into person_lesson (person_id, lesson_id)
VALUES (3, 5);

select * from person_lesson;

insert into person_lesson (person_id, lesson_id)
VALUES (3, 5);

select * from person_lesson;

insert into person_lesson (person_id, lesson_id)
VALUES (3, 6);

select * from person_lesson;

insert into person_lesson (person_id, lesson_id)
VALUES (3, 7);

select * from person_lesson;

insert into person_lesson (person_id, lesson_id)
VALUES (3, 8);

select * from person_lesson;

insert into person_lesson (person_id, lesson_id)
VALUES (4, 9);

select * from person_lesson;

insert into person_lesson (person_id, lesson_id)
VALUES (4, 10);

select * from person_lesson;

insert into person_lesson (person_id, lesson_id)
VALUES (4, 11);

select * from person_lesson;

insert into person_lesson (person_id, lesson_id)
VALUES (4, 11);

select * from person_lesson;

insert into person_lesson (person_id, lesson_id)
VALUES (4, 12);

select * from person_lesson;

insert into person_lesson (person_id, lesson_id)
VALUES (4, 13);

select * from person_lesson;

insert into person_lesson (person_id, lesson_id)
VALUES (1, 1);

select * from person_lesson;

insert into person_lesson (person_id, lesson_id)
VALUES (1, 2);

select * from person_lesson;

insert into person_lesson (person_id, lesson_id)
VALUES (1, 3);

select * from person_lesson;

insert into person_lesson (person_id, lesson_id)
VALUES (1, 4);

select * from person_lesson;

insert into person_lesson (person_id, lesson_id)
VALUES (1, 5);

select * from person_lesson;

insert into person_lesson (person_id, lesson_id)
VALUES (5, 1);

select * from person_lesson;

insert into person_lesson (person_id, lesson_id)
VALUES (5, 2);

select * from person_lesson;

insert into person_lesson (person_id, lesson_id)
VALUES (6, 1);

select * from person_lesson;

insert into person_lesson (person_id, lesson_id)
VALUES (6, 1);

select * from person_lesson;

insert into person_lesson (person_id, lesson_id)
VALUES (6, 2);

select * from person_lesson;

insert into person_lesson (person_id, lesson_id)
VALUES (6, 3);

select * from person_lesson;

insert into person_lesson (person_id, lesson_id)
VALUES (7, 1);

select * from person_lesson;

insert into person_lesson (person_id, lesson_id)
VALUES (7, 3);

select * from person_lesson;

insert into person_lesson (person_id, lesson_id)
VALUES (7, 4);

select * from person_lesson;

insert into person_lesson (person_id, lesson_id)
VALUES (8, 1);

select * from person_lesson;

insert into person_lesson (person_id, lesson_id)
VALUES (8, 2);

select * from person_lesson;

insert into person_lesson (person_id, lesson_id)
VALUES (8, 4);

select * from person_lesson;

insert into person_lesson (person_id, lesson_id)
VALUES (8, 5);

select * from person_lesson;

insert into person_lesson (person_id, lesson_id)
VALUES (8, 6);

select * from person_lesson;

insert into person_lesson (person_id, lesson_id)
VALUES (9, 1);

select * from person_lesson;

insert into person_lesson (person_id, lesson_id)
VALUES (9, 2);

select * from person_lesson;

insert into person_lesson (person_id, lesson_id)
VALUES (9, 5);

select * from person_lesson;

insert into person_lesson (person_id, lesson_id)
VALUES (9, 6);

select * from person_lesson;

insert into person_lesson (person_id, lesson_id)
VALUES (10, 1);

select * from person_lesson;

insert into person_lesson (person_id, lesson_id)
VALUES (11, 2);

select * from person_lesson;

insert into person_lesson (person_id, lesson_id)
VALUES (11, 3);

select * from person_lesson;

insert into person_lesson (person_id, lesson_id)
VALUES (12, 1);

select * from person_lesson;

insert into person_lesson (person_id, lesson_id)
VALUES (12, 2);

select * from person_lesson;

insert into person_lesson (person_id, lesson_id)
VALUES (12, 3);

select * from person_lesson;

insert into person_lesson (person_id, lesson_id)
VALUES (12, 4);

select * from person_lesson;

insert into person_lesson (person_id, lesson_id)
VALUES (12, 5);

select * from person_lesson;

insert into person_lesson (person_id, lesson_id)
VALUES (12, 6);

select * from person_lesson;

insert into person_lesson (person_id, lesson_id)
VALUES (13, 1);

select * from person_lesson;

insert into person_lesson (person_id, lesson_id)
VALUES (13, 2);

select * from person_lesson;

insert into person_lesson (person_id, lesson_id)
VALUES (13, 3);

select * from person_lesson;

insert into person_lesson (person_id, lesson_id)
VALUES (13, 4);

select * from person_lesson;

insert into person_lesson (person_id, lesson_id)
VALUES (13, 5);

select * from person_lesson;

insert into person_lesson (person_id, lesson_id)
VALUES (13, 6);

select * from person_lesson;

insert into person_lesson (person_id, lesson_id)
VALUES (14, 1);

select * from person_lesson;

insert into person_lesson (person_id, lesson_id)
VALUES (14, 2);

select * from person_lesson;

insert into person_lesson (person_id, lesson_id)
VALUES (14, 3);

select * from person_lesson;

insert into person_lesson (person_id, lesson_id)
VALUES (14, 5);

select * from person_lesson;

insert into person_lesson (person_id, lesson_id)
VALUES (15, 1);

select * from person_lesson;

insert into person_lesson (person_id, lesson_id)
VALUES (15, 2);

select * from person_lesson;

insert into person_lesson (person_id, lesson_id)
VALUES (16, 1);

select * from person_lesson;

insert into person_lesson (person_id, lesson_id)
VALUES (17, 1);

select * from person_lesson;

insert into person_lesson (person_id, lesson_id)
VALUES (17, 2);

select * from person_lesson;

insert into person_lesson (person_id, lesson_id)
VALUES (17, 3);

select * from person_lesson;

insert into person_lesson (person_id, lesson_id)
VALUES (17, 4);

select * from person_lesson;

insert into person_lesson (person_id, lesson_id)
VALUES (17, 5);

select * from person_lesson;

insert into person_lesson (person_id, lesson_id)
VALUES (17, 6);

select * from person_lesson;

insert into person_lesson (person_id, lesson_id)
VALUES (18, 2);

select * from person_lesson;

insert into person_lesson (person_id, lesson_id)
VALUES (18, 3);

select * from person_lesson;

insert into person_lesson (person_id, lesson_id)
VALUES (19, 1);

select * from person_lesson;

insert into person_lesson (person_id, lesson_id)
VALUES (20, 1);

select * from person_lesson;

insert into person_lesson (person_id, lesson_id)
VALUES (20, 2);

select * from person_lesson;

insert into person_lesson (person_id, lesson_id)
VALUES (20, 3);

select * from person_lesson;

insert into person_lesson (person_id, lesson_id)
VALUES (20, 4);

select * from person_lesson;

insert into person_lesson (person_id, lesson_id)
VALUES (20, 5);

select * from person_lesson;

insert into person_lesson (person_id, lesson_id)
VALUES (20, 6);

select * from person_lesson;

insert into person_lesson (person_id, lesson_id)
VALUES (21, 1);

select * from person_lesson;

insert into person_lesson (person_id, lesson_id)
VALUES (21, 3);

select * from person_lesson;

insert into person_lesson (person_id, lesson_id)
VALUES (22, 1);

select * from person_lesson;

insert into person_lesson (person_id, lesson_id)
VALUES (23, 2);

select * from person_lesson;

insert into person_lesson (person_id, lesson_id)
VALUES (23, 4);

select * from person_lesson;

insert into person_lesson (person_id, lesson_id)
VALUES (24, 1);

select * from person_lesson;

insert into person_lesson (person_id, lesson_id)
VALUES (25, 1);

select * from person_lesson;

insert into person_lesson (person_id, lesson_id)
VALUES (25, 2);

select * from person_lesson;

insert into person_lesson (person_id, lesson_id)
VALUES (25, 2);

select * from person_lesson;

insert into person_lesson (person_id, lesson_id)
VALUES (26, 1);

select * from person_lesson;

insert into person_lesson (person_id, lesson_id)
VALUES (27, 1);

select * from person_lesson;

insert into person_lesson (person_id, lesson_id)
VALUES (27, 2);

select * from person_lesson;

insert into person_lesson (person_id, lesson_id)
VALUES (27, 3);

select * from person_lesson;

insert into person_lesson (person_id, lesson_id)
VALUES (27, 4);

select * from person_lesson;

insert into person_lesson (person_id, lesson_id)
VALUES (27, 5);

select * from person_lesson;

insert into person_lesson (person_id, lesson_id)
VALUES (27, 6);

select * from person_lesson;

insert into material_lesson (material_id, lesson_id)
VALUES (1, 1);

select * from material_lesson;

insert into material_lesson (material_id, lesson_id)
VALUES (3, 1);

delete
from material_lesson;

select * from material_lesson;

select * from material_lesson;

insert into material_lesson (material_id, lesson_id)
VALUES (1, 1);

select * from material_lesson;

insert into material_lesson (material_id, lesson_id)
VALUES (1, 11);

select * from material_lesson;

insert into material_lesson (material_id, lesson_id)
VALUES (1, 12);

select * from material_lesson;

insert into material_lesson (material_id, lesson_id)
VALUES (1, 13);

select * from material_lesson;

insert into material_lesson (material_id, lesson_id)
VALUES (2, 6);

select * from material_lesson;

insert into material_lesson (material_id, lesson_id)
VALUES (2, 7);

select * from material_lesson;

insert into material_lesson (material_id, lesson_id)
VALUES (2, 8);

select * from material_lesson;

insert into material_lesson (material_id, lesson_id)
VALUES (2, 9);

select * from material_lesson;

insert into material_lesson (material_id, lesson_id)
VALUES (2, 10);

select * from material_lesson;

insert into material_lesson (material_id, lesson_id)
VALUES (3, 11);

select * from material_lesson;

insert into material_lesson (material_id, lesson_id)
VALUES (3, 1);

select * from material_lesson;

insert into material_lesson (material_id, lesson_id)
VALUES (3, 12);

select * from material_lesson;

insert into material_lesson (material_id, lesson_id)
VALUES (3, 13);

select * from material_lesson;

insert into material_lesson (material_id, lesson_id)
VALUES (4, 2);

select * from material_lesson;

insert into material_lesson (material_id, lesson_id)
VALUES (4, 3);

select * from material_lesson;

insert into material_lesson (material_id, lesson_id)
VALUES (4, 4);

select * from material_lesson;

insert into material_lesson (material_id, lesson_id)
VALUES (4, 5);

select * from material_lesson;

insert into material_lesson (material_id, lesson_id)
VALUES (5, 2);

select * from material_lesson;

insert into material_lesson (material_id, lesson_id)
VALUES (5, 3);

select * from material_lesson;

insert into material_lesson (material_id, lesson_id)
VALUES (5, 4);

select * from material_lesson;

insert into material_lesson (material_id, lesson_id)
VALUES (5, 5);

select * from material_lesson;

insert into material_lesson (material_id, lesson_id)
VALUES (6, 8);

select * from material_lesson;

insert into material_lesson (material_id, lesson_id)
VALUES (7, 1);

select * from material_lesson;

insert into material_lesson (material_id, lesson_id)
VALUES (7, 11);

select * from material_lesson;

insert into material_lesson (material_id, lesson_id)
VALUES (7, 12);

select * from material_lesson;

insert into material_lesson (material_id, lesson_id)
VALUES (7, 13);

select * from material_lesson;

insert into material_lesson (material_id, lesson_id)
VALUES (8, 1);

select * from material_lesson;

insert into material_lesson (material_id, lesson_id)
VALUES (8, 11);

select * from material_lesson;

insert into material_lesson (material_id, lesson_id)
VALUES (8, 12);

select * from material_lesson;

insert into material_lesson (material_id, lesson_id)
VALUES (8, 13);

select * from material_lesson;

select last_name, first_name, email, phone, country, city, street, house
from persons inner join
    contacts c on persons.person_id = c.persons_id
    inner join
    adress a on a.adress_id = persons.adress_id
order by last_name;

select distinct last_name, first_name, email, phone, country, city, street, house
from persons inner join
    contacts c on persons.person_id = c.persons_id
    inner join
    adress a on a.adress_id = persons.adress_id
group by last_name;

select last_name, first_name, email, AVG(time)
from persons inner join
    contacts c on persons.person_id = c.persons_id
inner join
    person_lesson pl on persons.person_id = pl.person_id
inner join lessons l on l.lesson_id = pl.lesson_id
group by last_name, first_name, email;

select last_name, first_name, email, AVG(time)
from persons inner join
    contacts c on persons.person_id = c.persons_id
inner join
    person_lesson pl on persons.person_id = pl.person_id
inner join lessons l on l.lesson_id = pl.lesson_id
where email in (select email
from persons inner join contacts c on persons.person_id = c.persons_id
group by persons.person_id)
group by last_name, first_name, email;

select email
from (select last_name, email
from persons inner join contacts c on persons.person_id = c.persons_id
group by last_name);

insert into persons (person_id, first_name, last_name, role, adress_id, gender)
VALUES (28, 'Egor', 'Abramov', 'student', 28, 'male');

select * from persons;

select last_name, count(last_name) AS amount
from persons
GROUP BY last_name
HAVING count(last_name) > 1;

select first_name, count(first_name) AS amount
from persons
GROUP BY first_name
HAVING count(first_name) > 1;

insert into person_lesson
values (28, 1);

insert into person_lesson
values (28, 2);

insert into contacts (contact_id, persons_id)
values (31, 28);

select * from contacts;

select last_name, first_name, email, phone, MAX(Sum_Time)
from (select last_name, first_name, email, phone, SUM(time) AS Sum_Time
from persons inner join
    contacts c on persons.person_id = c.persons_id
inner join
    person_lesson pl on persons.person_id = pl.person_id
inner join
    lessons l on l.lesson_id = pl.lesson_id
group by last_name, first_name, email, phone)
group by last_name, first_name, email, phone;

select last_name, first_name, email, phone
from (select last_name, first_name, email,
             phone, role, COUNT(l.lesson_id) AS lesson_amount
from persons inner join
    contacts c on persons.person_id = c.persons_id
inner join
    person_lesson pl on persons.person_id = pl.person_id
inner join
    lessons l on l.lesson_id = pl.lesson_id
where role <> 'teacher'
group by last_name, first_name, email, phone, role)
WHERE lesson_amount = (select MAX(lesson_amount)
from (select last_name, first_name, email,
             phone, role, COUNT(l.lesson_id) AS lesson_amount
from persons inner join
    contacts c on persons.person_id = c.persons_id
inner join
    person_lesson pl on persons.person_id = pl.person_id
inner join
    lessons l on l.lesson_id = pl.lesson_id
where role <> 'teacher'
group by last_name, first_name, email, phone, role)) and email in (select email
from persons inner join contacts c on persons.person_id = c.persons_id
group by persons.person_id);

select last_name, first_name, email, phone
from (select last_name, first_name, email,
             phone, role, SUM(time) AS Sum_Time
from persons inner join
    contacts c on persons.person_id = c.persons_id
inner join
    person_lesson pl on persons.person_id = pl.person_id
inner join
    lessons l on l.lesson_id = pl.lesson_id
where role <> 'teacher'
group by last_name, first_name, email, phone, role)
WHERE Sum_Time = (select MAX(Sum_Time)
from (select last_name, first_name, email,
             phone, role, SUM(time) AS Sum_Time
from persons inner join
    contacts c on persons.person_id = c.persons_id
inner join
    person_lesson pl on persons.person_id = pl.person_id
inner join
    lessons l on l.lesson_id = pl.lesson_id
where role <> 'teacher'
group by last_name, first_name, email, phone, role))  and email in (select email
from persons inner join contacts c on persons.person_id = c.persons_id
group by persons.person_id);

select last_name, first_name, email, phone
from (select last_name, first_name, email,
             phone, role, SUM(time) AS Sum_Time
from persons inner join
    contacts c on persons.person_id = c.persons_id
inner join
    person_lesson pl on persons.person_id = pl.person_id
inner join
    lessons l on l.lesson_id = pl.lesson_id
where role <> 'student'
group by last_name, first_name, email, phone, role)
WHERE Sum_Time = (select MAX(Sum_Time)
from (select last_name, first_name, email,
             phone, role, SUM(time) AS Sum_Time
from persons inner join
    contacts c on persons.person_id = c.persons_id
inner join
    person_lesson pl on persons.person_id = pl.person_id
inner join
    lessons l on l.lesson_id = pl.lesson_id
where role <> 'student'
group by last_name, first_name, email, phone, role))
   and email in (select email
from persons inner join contacts c on persons.person_id = c.persons_id
group by persons.person_id);

select last_name, first_name, material_name
from material
    inner join
    material_lesson ml on material.material_id = ml.material_id
inner join lessons l on l.lesson_id = ml.lesson_id
inner join person_lesson pl on l.lesson_id = pl.lesson_id
inner join persons p on pl.person_id = p.person_id
where role <> 'teacher'
order by last_name, first_name;

select last_name, first_name, material_name
from material
    inner join
    material_lesson ml on material.material_id = ml.material_id
inner join lessons l on l.lesson_id = ml.lesson_id
inner join person_lesson pl on l.lesson_id = pl.lesson_id
inner join persons p on pl.person_id = p.person_id
where role <> 'teacher'
group by material.material_id, p.person_id
order by last_name, first_name;

select country
from
    (select country, last_name, first_name, count(lesson_id) AS lesson_amount
from adress inner join
    persons p on adress.adress_id = p.adress_id
inner join person_lesson pl on p.person_id = pl.person_id
where role <> 'teacher'
group by p.person_id)
where lesson_amount in (select max(lesson_amount)
                        from (select country, last_name, first_name, count(lesson_id) AS lesson_amount
from adress inner join
    persons p on adress.adress_id = p.adress_id
inner join person_lesson pl on p.person_id = pl.person_id
where role <> 'teacher'
group by p.person_id));

select city
from
    (select country, city, last_name, first_name, sum(time) AS lesson_time
from adress inner join
    persons p on adress.adress_id = p.adress_id
inner join person_lesson pl on p.person_id = pl.person_id
inner join lessons l on pl.lesson_id = l.lesson_id
where role <> 'teacher'
group by p.person_id)
where lesson_time in (select max(lesson_time)
 from (select country, city, last_name, first_name, sum(time) AS lesson_time
from adress inner join
    persons p on adress.adress_id = p.adress_id
inner join person_lesson pl on p.person_id = pl.person_id
inner join lessons l on pl.lesson_id = l.lesson_id
where role <> 'teacher'
group by p.person_id)));
